#include "common.h"

float2 main(float2 tc : TEXCOORDD, float4 pos2d : SV_Position) : SV_Target
{
#ifdef USE_AREF
	float4 C = s_base.Sample(smp_base, tc);
	clip(C.w - def_aref);
#endif
	
	float depth = pos2d.z;
	
	float dx = ddx(depth);
	float dy = ddy(depth);
	
	float2 moments;
	moments.x = depth;
	moments.y = depth*depth + 0.25 * (dx*dx + dy*dy);

	return moments;
}